# Private File Sharing

![Логотип Private File Sharing](https://via.placeholder.com/800x200?text=Private+File+Sharing) <!-- Замените на актуальный логотип, если есть -->

Надежная, безопасная и масштабируемая платформа для приватного обмена файлами, разработанная для организаций, которым требуется детализированный контроль доступа, управление пользователями и бесшовные уведомления. Построена на основе микросервисной архитектуры для обеспечения высокой доступности, легкого масштабирования и удобной поддержки кода. Будь то работа с конфиденциальными документами или совместными файлами, приложение предоставляет ролевой доступ, аутентификацию через JWT и событийно-ориентированные уведомления.

## Основные возможности

- **Управление пользователями**: Регистрация, аутентификация и управление пользователями с ролями (admin, pro, default). Администраторы могут создавать, обновлять или удалять пользователей.
- **Управление файлами**: Загрузка, получение, изменение уровня доступа и удаление файлов (поддержка PDF, Word и т.д.). Доступ регулируется уровнями (default, pro, admin).
- **Безопасная аутентификация**: Логин на основе JWT с хешированием паролей и ролевым управлением доступом (RBAC).
- **Уведомления**: Уведомления пользователей в реальном времени через Kafka для событий, таких как передача файлов или обновления.
- **API-шлюз**: Централизованная точка входа для всех запросов, обеспечивающая маршрутизацию, CORS и балансировку нагрузки.
- **Масштабируемость**: Микросервисная архитектура позволяет независимо масштабировать сервисы для пользователей и файлов.

## Технологический стек

Проект использует современные технологии промышленного уровня для обеспечения производительности, безопасности и удобства для разработчиков. Основной акцент сделан на экосистему Java для надежности бэкенда и асинхронный обмен сообщениями для слабосвязанных сервисов.

### Бэкенд
- **Java 17+**: Основной язык для всех сервисов, обеспечивающий кроссплатформенность и строгую типизацию.
- **Spring Boot 3.x**: Фреймворк для создания готовых к продакшену микросервисов с автоконфигурацией и встроенными серверами.
- **Spring Security**: Обеспечивает аутентификацию, авторизацию, генерацию/валидацию JWT-токенов и ролевое управление доступом (RBAC).
- **Spring Data JPA**: ORM для взаимодействия с базой данных, абстрагирующий CRUD-операции через репозитории.
- **Spring Cloud Gateway**: Используется как API-шлюз для маршрутизации запросов к микросервисам, с поддержкой фильтров, устойчивости и ограничения скорости.
- **Spring Kafka**: Интеграция с Apache Kafka для событийно-ориентированной архитектуры, обеспечивающей асинхронные уведомления.
- **Apache Kafka**: Брокер сообщений для надежной распределенной передачи событий между сервисами (например, события пользователей для уведомлений).
- **RESTful API**: Открытые конечные точки с JSON-ответами, поддержка CORS для интеграции с фронтендом.

### База данных
- **Реляционная база данных (например, PostgreSQL/MySQL)**: Хранит данные пользователей, метаданные файлов и уровни доступа с использованием сущностей Spring Data JPA. Схема включает таблицы для пользователей (id, email, role, hashed_password) и файлов (id, name, access_level, upload_date).

### Фронтенд
- **HTML5 & CSS3 с Tailwind CSS**: Адаптивный интерфейс с современным дизайном без тяжелых фреймворков.
- **Vanilla JavaScript**: Обработка клиентской логики, вызовов API и динамических обновлений (без React/Vue для легковесности).

### Сборка и деплой
- **Maven**: Управление зависимостями и сборка через `pom.xml` для мультимодульной структуры.
- **Docker (опционально)**: Контейнеризация сервисов с возможными Dockerfile для каждого микросервиса.
- **Другие инструменты**: Lombok для сокращения шаблонного кода, JUnit для тестирования, SLF4J для логирования.

## Архитектура проекта

Проект построен на микросервисной архитектуре для модульности и изоляции ошибок. Фронтенд взаимодействует только с API-шлюзом, который маршрутизирует запросы к специализированным сервисам. Операции, связанные с пользователями, могут инициировать уведомления через Kafka для разделения ответственности.

### Поток обработки запросов
1. Фронтенд отправляет HTTP-запросы (например, логин, загрузка файла) на API-шлюз.
2. API-шлюз аутентифицирует (через JWT) и перенаправляет запрос к соответствующему микросервису.
3. Микросервис пользователей обрабатывает аутентификацию, CRUD-операции и отправляет события в Kafka для уведомлений.
4. Микросервис файлов управляет операциями с файлами и их хранением.
5. Сервис уведомлений потребляет Kafka-топики для отправки email или уведомлений в приложении.

### Схема архитектуры

```mermaid
graph TD
    A[Фронтенд] -->|HTTP-запросы| B[API-шлюз]
    B -->|Маршруты /users/*| C[Микросервис пользователей]
    B -->|Маршруты /files/*| D[Микросервис файлов]
    C -->|Отправляет события| E[Kafka-брокер]
    E -->|Потребляет топики| F[Сервис уведомлений]
    C <-->|Запросы к БД| G[База данных]
    D <-->|Запросы к БД| G
```

Эта схема показывает поток запросов и событийно-ориентированное взаимодействие. API-шлюз выступает единой точкой входа, повышая безопасность и упрощая интеграцию с клиентом.

## Структура проекта

Репозиторий организован как мультимодульный Maven-проект для удобного управления микросервисами:

- **api-gateway/**: Содержит конфигурацию Spring Cloud Gateway, правила маршрутизации и фильтры безопасности.
  - `src/main/java`: Контроллеры/фильтры для обработки запросов.
  - `application.yml`: Конфигурация маршрутов (например, к сервисам пользователей и файлов).
- **user-microservice/**: Отвечает за логику, связанную с пользователями.
  - `src/main/java`: Сущности (User), репозитории, сервисы, контроллеры (например, /auth/login, /users).
  - Kafka-продюсеры для событий уведомлений.
- **file-microservice/**: Управляет операциями с файлами.
  - `src/main/java`: Сущности (File), репозитории, сервисы, контроллеры (например, /files/upload, /files/{id}).
- **notifier/**: Потребляет сообщения Kafka для отправки уведомлений.
  - Простое Spring Boot-приложение с Kafka-листенерами.
- **frontend/**: Статические ресурсы для интерфейса.
  - HTML-страницы, JS-скрипты для работы с API, стили Tailwind.
- **pom.xml**: Корневой Maven-файл для сборки всех модулей.
- **docker-compose.yml** (опционально): Для локальной оркестрации сервисов и Kafka.

## Установка и запуск

1. **Клонируйте репозиторий**:
   ```
   git clone https://github.com/vnikolaenko-dev/PrivateFileSharing.git
   cd PrivateFileSharing
   git checkout api-gateway
   ```

2. **Установите зависимости**:
   ```
   mvn clean install
   ```

3. **Настройте окружение**:
   - Обновите файлы `application.properties` или `.yml` в каждом модуле (например, URL базы данных, серверы Kafka).
   - Пример для микросервиса пользователей:
     ```
     spring.datasource.url=jdbc:postgresql://localhost:5432/privatefiles
     spring.kafka.bootstrap-servers=localhost:9092
     ```

4. **Запустите сервисы**:
   - Запустите Kafka/Zookeeper (например, через Docker: `docker run -p 9092:9092 apache/kafka`).
   - Запустите каждый микросервис: `mvn spring-boot:run` в соответствующих директориях.
   - Или используйте Docker Compose для всех сервисов.

5. **Доступ к приложению**:
   - Фронтенд: Откройте `index.html` или запустите локальный сервер.
   - API: Тестируйте конечные точки через Postman (например, POST /auth/login).
